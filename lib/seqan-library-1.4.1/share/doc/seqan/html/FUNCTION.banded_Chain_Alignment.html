<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><link rel="stylesheet" href="dddoc_html.css" type="text/css" /><title>bandedChainAlignment</title></head><body><table id=main_table cellspacing=0 cellpadding=0><tr><td valign=top><iframe frameborder=0 id=navigation src="INDEX_Function_Alignments.html#bandedChainAlignment"></iframe></td><td valign=top><div id=content><div class=page_category>Function</div><div class=page_title>bandedChainAlignment</div><div id=summary><div class=text>Computes the best global pairwise alignment between two sequences given a non-empty seed chain.</div></div><div class=section id=signature><div class=signature_block><nobr><span class=code><nobr>bandedChainAlignment(align,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seedChain,&nbsp;scoringScheme1&nbsp;[,&nbsp;scoringScheme2]&nbsp;[,&nbsp;alignConfig]&nbsp;[,&nbsp;k])</nobr></span></nobr></div><div class=signature_block><nobr><span class=code><nobr>bandedChainAlignment(gapsH,&nbsp;gapsV,&nbsp;&nbsp;&nbsp;seedChain,&nbsp;scoringScheme1&nbsp;[,&nbsp;scoringScheme2]&nbsp;[,&nbsp;alignConfig]&nbsp;[,&nbsp;k])</nobr></span></nobr></div><div class=signature_block><nobr><span class=code><nobr>bandedChainAlignment(frags,&nbsp;strings,&nbsp;seedChain,&nbsp;scoringScheme1&nbsp;[,&nbsp;scoringScheme2]&nbsp;[,&nbsp;alignConfig]&nbsp;[,&nbsp;k])</nobr></span></nobr></div><div class=signature_block><nobr><span class=code><nobr>bandedChainAlignment(alignmentGraph,&nbsp;seedChain,&nbsp;scoringScheme1&nbsp;[,&nbsp;scoringScheme2]&nbsp;[,&nbsp;alignConfig]&nbsp;[,&nbsp;k])</nobr></span></nobr></div></div><div class=section id=include><div class=section_headline>Include Headers</div><div class=text_block>seqan/seeds.h</div></div><div class=section id=param><div class=section_headline>Parameters</div><table class=value_tab cellspacing=0 cellpadding=0><tr><td class=value_key valign=top><nobr>align</nobr></td><td class=value_text valign=top><div class=text_sub_block> 
An <a href="CLASS_Align.html" title="An alignment of sequences." >Align</a> object that stores the alignment.
The number of rows must be 2 and the sequences must have already been set.
<span class=code><nobr>row(align,&nbsp;0)</nobr></span> is the horizontal sequence in the alignment matrix, <span class=code><nobr>row(align,&nbsp;1)</nobr></span> is the vertical sequence.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_Align.html" title="An alignment of sequences." >Align</a></div></td></tr><tr><td class=value_key valign=top><nobr>gapsH</nobr></td><td class=value_text valign=top><div class=text_sub_block> Horizontal gapped sequence in alignment matrix.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_Gaps.html" title="Efficient storage of gaps for a sequence." >Gaps</a></div></td></tr><tr><td class=value_key valign=top><nobr>gapsV</nobr></td><td class=value_text valign=top><div class=text_sub_block> Vertical gapped sequence in alignment matrix.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_Gaps.html" title="Efficient storage of gaps for a sequence." >Gaps</a></div></td></tr><tr><td class=value_key valign=top><nobr>frags</nobr></td><td class=value_text valign=top><div class=text_sub_block> 
String of <a href="CLASS_Fragment.html" title="A type for ungapped, pairwise segment matches." >Fragment</a> objects.
The sequence with id <span class=code><nobr>0</nobr></span> is the horizontal one, the sequence with id <span class=code><nobr>1</nobr></span> is the vertical one.</div></td></tr><tr><td class=value_key valign=top><nobr>alignmentGraph</nobr></td><td class=value_text valign=top><div class=text_sub_block> 
<a href="SPEC_Alignment+_Graph.html" title="An alignment graph." >Alignment Graph</a> object to store the alignment in.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="SPEC_Alignment+_Graph.html" title="An alignment graph." >Alignment Graph</a></div><div class=text_sub_block><span class=section_sub_headline>Remarks:</span> The underlying <a href="CLASS_String_Set.html" title="A container class for a set of strings." >StringSet</a> must be an <a href="SPEC_Dependent.html" title="A string set storing references of the strings." >Dependent StringSet</a>.</div></td></tr><tr><td class=value_key valign=top><nobr>strings</nobr></td><td class=value_text valign=top><div class=text_sub_block> A <a href="CLASS_String_Set.html" title="A container class for a set of strings." >StringSet</a> containing two sequences.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_String_Set.html" title="A container class for a set of strings." >StringSet</a></div></td></tr><tr><td class=value_key valign=top><nobr>seedChain</nobr></td><td class=value_text valign=top><div class=text_sub_block> 
The container holding the <a href="CLASS_Seed.html" title="A seed in a dotplot." >seeds</a>. Note that the <a href="CLASS_Seed.html" title="A seed in a dotplot." >seeds</a> have to be in montonic non-decreasing order
and the container has to implement a forward-iterator.</div><div class=text_sub_block><span class=section_sub_headline>See:</span> <a href="CLASS_Seed_Set.html" title="Handles a set of seeds with local chaining on adding seeds." >SeedSet</a></div></td></tr><tr><td class=value_key valign=top><nobr>scoringScheme1</nobr></td><td class=value_text valign=top><div class=text_sub_block> The scoring scheme used for the alignment.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_Score.html" title="A scoring scheme." >Score</a></div><div class=text_sub_block><span class=section_sub_headline>Remarks:</span> If <span class=code><nobr>scoringScheme2</nobr></span> is specified, then <span class=code><nobr>scoringScheme1</nobr></span> is used for the regions around the seeds
and <span class=code><nobr>scoringScheme2</nobr></span> for the gap regions between two consecutive seeds.</div></td></tr><tr><td class=value_key valign=top><nobr>scoringScheme2</nobr></td><td class=value_text valign=top><div class=text_sub_block> The optional scoring scheme for the gap regions between two anchors.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_Score.html" title="A scoring scheme." >Score</a></div></td></tr><tr><td class=value_key valign=top><nobr>alignConfig</nobr></td><td class=value_text valign=top><div class=text_sub_block> The <a href="CLASS_Align_Config.html" title="The AlignConfig class encapsulates how DP is carried out. It indicates at what ends gaps are free, the so-called free ends-space alignments." >AlignConfig</a> to use for the alignment.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_Align_Config.html" title="The AlignConfig class encapsulates how DP is carried out. It indicates at what ends gaps are free, the so-called free ends-space alignments." >AlignConfig</a></div></td></tr><tr><td class=value_key valign=top><nobr>k</nobr></td><td class=value_text valign=top><div class=text_sub_block> Optional extension of the band around the seeds.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <span class=code><nobr>int</nobr></span></div><div class=text_sub_block><span class=section_sub_headline>Default:</span> 15</div><div class=text_sub_block><span class=section_sub_headline>Remarks:</span> At the moment only band extensions greater or equal <span class=code><nobr>1</nobr></span> are allowed.</div></td></tr></table></div><div class=section id=remarks><div class=section_headline>Remarks</div><div class=text_block><div class=text_sub_block> 
There exist multiple overloads for this function with four configuration dimensions.</div><div class=text_sub_block> 
First, you can select whether begin and end gaps are free in either sequence using <span class=code><nobr>alignConfig</nobr></span>.</div><div class=text_sub_block> 
Second, you can select the type of the target storing the alignment.
This can be either an <a href="CLASS_Align.html" title="An alignment of sequences." >Align</a> object, two <a href="CLASS_Gaps.html" title="Efficient storage of gaps for a sequence." >Gaps</a> objects, a <a href="SPEC_Alignment+_Graph.html" title="An alignment graph." >Alignment Graph</a>, or a string of <a href="CLASS_Fragment.html" title="A type for ungapped, pairwise segment matches." >Fragment</a> objects.
<a href="CLASS_Align.html" title="An alignment of sequences." >Align</a> objects provide an interface to tabular alignments with the restriction of all rows having the same type.
Using two <a href="CLASS_Gaps.html" title="Efficient storage of gaps for a sequence." >Gaps</a> objects has the advantage that you can align sequences with different types, for example <a href="SHORTCUT_Dna_String.html" title="A string of Spec.Dna." >DnaString</a> and <a href="SHORTCUT_Dna5_String.html" title="A string of Spec.Dna5." >Dna5String</a>.
<a href="SPEC_Alignment+_Graph.html" title="An alignment graph." >Alignment Graphs</a> provide a graph-based representation of segment-based colinear alignments.
Using <a href="CLASS_Fragment.html" title="A type for ungapped, pairwise segment matches." >Fragment</a> strings is useful for collecting many pairwise alignments, for example in the construction of <a href="SPEC_Alignment+_Graph.html" title="An alignment graph." >Alignment Graphs</a> for multiple-sequence alignments (MSA).</div><div class=text_sub_block> 
Third, you can optionally give a second scoring scheme to fill the gaps between two consecutive seeds. Note that based on the specified scores
either an affine or linear gap cost function is used. This only depends on whether for one of the scoring schemes the scores for gap opening and gap extension differ or not.
If only one scoring scheme is defined the complete region is computed with the same scoring scheme.</div><div class=text_sub_block> 
Fourth, you can optinally select a proper band extension for the bands around the seeds. At the moment only band extensions of at least <span class=code><nobr>1</nobr></span> are allowed.
The default value is <span class=code><nobr>15</nobr></span> and is based on the default values for the LAGAN-algorithm described by Brudno et al., Genome Research, 2003.</div><div class=text_sub_block> 
The examples below show some common use cases.</div></div></div><div class=section id=returns><div class=section_headline>Return Values</div><div class=text_block><div class=text_sub_block> An integer with the alignment score, as given by the <a href="METAFUNCTION_Value.html" title="Type of the items in the container or behind an iterator." >Value</a> metafunction of the <a href="CLASS_Score.html" title="A scoring scheme." >Score</a> type.
If the seed chain is empty the metafunction <a href="METAFUNCTION_Min_Value.html" title="Infimum for a given type." >MinValue</a> is used to return the minimal value of the selected score type and no alignment is computed.</div></div></div><div class=section id=example><div class=section_headline>Examples</div><div class=text_block><div class=text_sub_block> Banded chain alignment of two sequences using an <a href="CLASS_Align.html" title="An alignment of sequences." >Align</a> object and using only one scoring scheme and no free end-gaps.</div><div class=code_sub_block><span class=code><nobr>Dna5String&nbsp;seqH&nbsp;=&nbsp;"CGAATCCATCCCACACA";<br >Dna5String&nbsp;seqV&nbsp;=&nbsp;"GGCGATNNNCATGGCACA";<br >&nbsp;<br >String&lt;Seed&lt;Simple&gt;&nbsp;&gt;&nbsp;seedChain;<br >appendValue(seedChain,&nbsp;Seed&lt;Simple&gt;(2,&nbsp;0,&nbsp;6,&nbsp;5));<br >appendValue(seedChain,&nbsp;Seed&lt;Simple&gt;(9,&nbsp;6,&nbsp;12,&nbsp;9));<br >appendValue(seedChain,&nbsp;Seed&lt;Simple&gt;(14,&nbsp;11,&nbsp;16,&nbsp;17));<br >&nbsp;<br >Align&lt;Dna5String,&nbsp;ArrayGaps&gt;&nbsp;alignment;<br >resize(rows(alignment),&nbsp;2);<br >assignSource(row(alignment,&nbsp;0),&nbsp;seqH);<br >assignSource(row(alignment,&nbsp;1),&nbsp;seqV);<br >&nbsp;<br >Score&lt;int,&nbsp;Simple&gt;&nbsp;scoringScheme(2,&nbsp;-1,&nbsp;-2);<br >&nbsp;<br >int&nbsp;result&nbsp;=&nbsp;bandedChainAlignment(alignment,&nbsp;seedChain,&nbsp;scoringScheme,&nbsp;2);</nobr></span></div><div class=text_sub_block> Banded chain alignment of two sequences using two <a href="CLASS_Gaps.html" title="Efficient storage of gaps for a sequence." >Gaps</a> objects, an unordered seed set to hold the seeds,
two different scoring schemes for the gaps between the seeds and the seeds and free end-gaps.</div><div class=code_sub_block><span class=code><nobr>DnaString&nbsp;seqH&nbsp;=&nbsp;"CGAATCCATCCCACACA";<br >Dna5String&nbsp;seqV&nbsp;=&nbsp;"GGCGATNNNCATGGCACA";<br >&nbsp;<br >SeedSet&lt;Simple,&nbsp;Unordered&gt;&nbsp;seedChain;<br >addSeed(seedChain,&nbsp;Seed&lt;Simple&gt;(2,&nbsp;0,&nbsp;6,&nbsp;5),&nbsp;Single());<br >addSeed(seedChain,&nbsp;Seed&lt;Simple&gt;(9,&nbsp;6,&nbsp;12,&nbsp;9),&nbsp;Single());<br >addSeed(seedChain,&nbsp;Seed&lt;Simple&gt;(14,&nbsp;11,&nbsp;16,&nbsp;17),&nbsp;Single());<br >&nbsp;<br >Gaps&lt;DnaString,&nbsp;ArrayGaps&gt;&nbsp;gapsH(seqH);<br >Gaps&lt;Dna5String,&nbsp;AnchorGaps&lt;&gt;&nbsp;&gt;&nbsp;gapsV(seqV);<br >&nbsp;<br >Score&lt;int,&nbsp;Simple&gt;&nbsp;scoringSchemeSeed(2,&nbsp;-1,&nbsp;-2);<br >Score&lt;int,&nbsp;Simple&gt;&nbsp;scoringSchemeGap(5,&nbsp;-3,&nbsp;-1,&nbsp;-5);<br >AlignConfig&lt;true,&nbsp;true,&nbsp;true,&nbsp;true&gt;&nbsp;alignConfig;<br >&nbsp;<br >int&nbsp;result&nbsp;=&nbsp;globalAlignment(gapsH,&nbsp;gapsV,&nbsp;scoringSchemeSeed,&nbsp;scoringSchemeGap,&nbsp;alignConfig,&nbsp;2);</nobr></span></div></div></div><div class=page_footline>SeqAn - Sequence Analysis Library - <a href="http://www.seqan.de">www.seqan.de</a></div><div id=page_widthblock>&nbsp;</div></div></td></tr></table><p style="font-size:50%; color: #909090">Page built @2013/07/11 10:43:57</p></body></html>