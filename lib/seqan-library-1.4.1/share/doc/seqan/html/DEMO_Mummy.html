<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><link rel="stylesheet" href="dddoc_html.css" type="text/css" /><title>Mummy</title></head><body><table id=main_table cellspacing=0 cellpadding=0><tr><td valign=top><iframe frameborder=0 id=navigation src="INDEX_Demo_Index.html#Mummy"></iframe></td><td valign=top><div id=content><div class=page_category>Example Program</div><div class=page_title>Mummy</div><div id=summary><div class=text>Simple MUMmer clone.</div></div><div class=section id=description><div class=text_block><div class=text_sub_block> MUMmer is a tool to search for multiple exact matches (MUMs) between 2 given sequences.
MUMs can be used as a starting point for a multiple genome alignment algorithm.
This example shows how to implement a simple version of MUMer to find multiple exact matches of n sequences (n&#x2265;2) in SeqAn.</div></div></div><div class=section_headline>File "<a href="index_mummy.cpp">index_mummy.cpp</a>"</div><div class=codefile ><table cellspacing=0 cellpadding=0 class=codefiletab><tr><td align=right class=linenumber>1</td><td class=content><nobr>#include&nbsp;&lt;iostream&gt;<br ></nobr></td></tr><tr><td align=right class=linenumber>2</td><td class=content><nobr>#include&nbsp;&lt;fstream&gt;<br ></nobr></td></tr><tr><td align=right class=linenumber>3</td><td class=content><nobr>#include&nbsp;&lt;seqan/index.h&gt;<br ></nobr></td></tr><tr><td align=right class=linenumber>4</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>5</td><td class=content><nobr>using&nbsp;namespace&nbsp;std;<br ></nobr></td></tr><tr><td align=right class=linenumber>6</td><td class=content><nobr>using&nbsp;namespace&nbsp;seqan;<br ></nobr></td></tr><tr><td align=right class=linenumber>7</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>8</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>9</td><td class=content><nobr>template&nbsp;&lt;typename&nbsp;TIndex&gt;<br ></nobr></td></tr><tr><td align=right class=linenumber>10</td><td class=content><nobr>void&nbsp;findMUMs(TIndex&nbsp;&amp;esa,&nbsp;unsigned&nbsp;minLen)<br ></nobr></td></tr><tr><td align=right class=linenumber>11</td><td class=content><nobr>{<br ></nobr></td></tr><tr><td align=right class=linenumber>12</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;typename&nbsp;Iterator&lt;TIndex,&nbsp;Mums&gt;::Type&nbsp;it(esa,&nbsp;minLen);&nbsp;&nbsp;//&nbsp;set&nbsp;minimum&nbsp;MUM&nbsp;length<br ></nobr></td></tr><tr><td align=right class=linenumber>13</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;String&lt;&nbsp;typename&nbsp;SAValue&lt;TIndex&gt;::Type&nbsp;&gt;&nbsp;occs;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;temp.&nbsp;string&nbsp;storing&nbsp;the&nbsp;hit&nbsp;positions<br ></nobr></td></tr><tr><td align=right class=linenumber>14</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>15</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;resetiosflags(ios::left);<br ></nobr></td></tr><tr><td align=right class=linenumber>16</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(!atEnd(it))&nbsp;<br ></nobr></td></tr><tr><td align=right class=linenumber>17</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>18</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;occs&nbsp;=&nbsp;getOccurrences(it);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;gives&nbsp;hit&nbsp;positions&nbsp;(seqNo,seqOfs)<br ></nobr></td></tr><tr><td align=right class=linenumber>19</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orderOccurrences(occs);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;order&nbsp;them&nbsp;by&nbsp;seqNo<br ></nobr></td></tr><tr><td align=right class=linenumber>20</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br ></nobr></td></tr><tr><td align=right class=linenumber>21</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(unsigned&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;length(occs);&nbsp;++i)<br ></nobr></td></tr><tr><td align=right class=linenumber>22</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;setw(8)<br ></nobr></td></tr><tr><td align=right class=linenumber>23</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;getValueI2(occs[i])&nbsp;+&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;output&nbsp;them&nbsp;in&nbsp;MUMmer's&nbsp;output&nbsp;format<br ></nobr></td></tr><tr><td align=right class=linenumber>24</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;"&nbsp;&nbsp;";<br ></nobr></td></tr><tr><td align=right class=linenumber>25</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>26</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;setw(8)&nbsp;<br ></nobr></td></tr><tr><td align=right class=linenumber>27</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;repLength(it)<br ></nobr></td></tr><tr><td align=right class=linenumber>28</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>29</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>30</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++it;<br ></nobr></td></tr><tr><td align=right class=linenumber>31</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>32</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;setiosflags(ios::left)&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>33</td><td class=content><nobr>}<br ></nobr></td></tr><tr><td align=right class=linenumber>34</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>35</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>36</td><td class=content><nobr>template&nbsp;&lt;typename&nbsp;TSpec&gt;<br ></nobr></td></tr><tr><td align=right class=linenumber>37</td><td class=content><nobr>int&nbsp;runMummy(int&nbsp;argc,&nbsp;const&nbsp;char&nbsp;*argv[],&nbsp;unsigned&nbsp;seqCount,&nbsp;unsigned&nbsp;minLen)<br ></nobr></td></tr><tr><td align=right class=linenumber>38</td><td class=content><nobr>{<br ></nobr></td></tr><tr><td align=right class=linenumber>39</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;typedef&nbsp;String&lt;Dna5,&nbsp;TSpec&gt;&nbsp;TString;<br ></nobr></td></tr><tr><td align=right class=linenumber>40</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;typedef&nbsp;StringSet&lt;TString&gt;&nbsp;&nbsp;TStringSet;<br ></nobr></td></tr><tr><td align=right class=linenumber>41</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;typedef&nbsp;Index&lt;TStringSet&gt;&nbsp;&nbsp;&nbsp;TIndex;<br ></nobr></td></tr><tr><td align=right class=linenumber>42</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>43</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;TIndex&nbsp;&nbsp;&nbsp;&nbsp;index;<br ></nobr></td></tr><tr><td align=right class=linenumber>44</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>45</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;import&nbsp;sequences<br ></nobr></td></tr><tr><td align=right class=linenumber>46</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;resize(indexText(index),&nbsp;seqCount);<br ></nobr></td></tr><tr><td align=right class=linenumber>47</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;arg&nbsp;=&nbsp;1,&nbsp;seq&nbsp;=&nbsp;0;&nbsp;arg&nbsp;&lt;&nbsp;argc;&nbsp;++arg)&nbsp;<br ></nobr></td></tr><tr><td align=right class=linenumber>48</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>49</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;skip&nbsp;two&nbsp;argument&nbsp;options<br ></nobr></td></tr><tr><td align=right class=linenumber>50</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(strcmp(argv[arg],&nbsp;"-p")&nbsp;==&nbsp;0&nbsp;||&nbsp;strcmp(argv[arg],&nbsp;"--profile")&nbsp;==&nbsp;0&nbsp;||<br ></nobr></td></tr><tr><td align=right class=linenumber>51</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcmp(argv[arg],&nbsp;"-l")&nbsp;==&nbsp;0&nbsp;||&nbsp;strcmp(argv[arg],&nbsp;"--minlen")&nbsp;==&nbsp;0)&nbsp;<br ></nobr></td></tr><tr><td align=right class=linenumber>52</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>53</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++arg;<br ></nobr></td></tr><tr><td align=right class=linenumber>54</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;<br ></nobr></td></tr><tr><td align=right class=linenumber>55</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>56</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>57</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(argv[arg][0]&nbsp;!=&nbsp;'-')&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>58</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ifstream&nbsp;file;<br ></nobr></td></tr><tr><td align=right class=linenumber>59</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.open(argv[arg],&nbsp;ios_base::in&nbsp;|&nbsp;ios_base::binary);<br ></nobr></td></tr><tr><td align=right class=linenumber>60</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!file.is_open())&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>61</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;"Import&nbsp;of&nbsp;sequence&nbsp;"&nbsp;&lt;&lt;&nbsp;argv[arg]&nbsp;&lt;&lt;&nbsp;"&nbsp;failed."&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>62</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;<br ></nobr></td></tr><tr><td align=right class=linenumber>63</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>64</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read(file,&nbsp;indexText(index)[seq],&nbsp;Fasta());<br ></nobr></td></tr><tr><td align=right class=linenumber>65</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.close();<br ></nobr></td></tr><tr><td align=right class=linenumber>66</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++seq;<br ></nobr></td></tr><tr><td align=right class=linenumber>67</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>68</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>69</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;lengthSum(indexText(index))&nbsp;&lt;&lt;&nbsp;"&nbsp;bps&nbsp;sequence&nbsp;imported."&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>70</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>71</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;findMUMs(index,&nbsp;minLen);<br ></nobr></td></tr><tr><td align=right class=linenumber>72</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>73</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br ></nobr></td></tr><tr><td align=right class=linenumber>74</td><td class=content><nobr>}<br ></nobr></td></tr><tr><td align=right class=linenumber>75</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>76</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>77</td><td class=content><nobr>void&nbsp;printHelp(int,&nbsp;const&nbsp;char&nbsp;*[],&nbsp;bool&nbsp;longHelp&nbsp;=&nbsp;false)&nbsp;<br ></nobr></td></tr><tr><td align=right class=linenumber>78</td><td class=content><nobr>{<br ></nobr></td></tr><tr><td align=right class=linenumber>79</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;"***************************************"&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>80</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;"***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simple&nbsp;MUM&nbsp;finder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;***"&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>81</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;"***&nbsp;written&nbsp;by&nbsp;David&nbsp;Weese&nbsp;(c)&nbsp;2007&nbsp;***"&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>82</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;"***************************************"&nbsp;&lt;&lt;&nbsp;endl&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>83</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;"Usage:&nbsp;mummy&nbsp;[OPTION]...&nbsp;&lt;SEQUENCE&nbsp;FILE&gt;&nbsp;...&nbsp;&lt;SEQUENCE&nbsp;FILE&gt;"&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>84</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(longHelp)&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>85</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;endl&nbsp;&lt;&lt;&nbsp;"Options:"&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>86</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;"&nbsp;&nbsp;-e,&nbsp;--extern&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\t"&nbsp;&lt;&lt;&nbsp;"use&nbsp;external&nbsp;memory&nbsp;(for&nbsp;large&nbsp;datasets)"&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>87</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;"&nbsp;&nbsp;-l,&nbsp;--minlen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\t"&nbsp;&lt;&lt;&nbsp;"set&nbsp;minimum&nbsp;MUM&nbsp;length"&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>88</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\t"&nbsp;&lt;&lt;&nbsp;"if&nbsp;not&nbsp;set,&nbsp;default&nbsp;value&nbsp;is&nbsp;20"&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>89</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;"&nbsp;&nbsp;-h,&nbsp;--help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\t"&nbsp;&lt;&lt;&nbsp;"print&nbsp;this&nbsp;help"&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>90</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>91</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;"Try&nbsp;'mummy&nbsp;--help'&nbsp;for&nbsp;more&nbsp;information."&nbsp;&lt;&lt;&nbsp;endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>92</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>93</td><td class=content><nobr>}<br ></nobr></td></tr><tr><td align=right class=linenumber>94</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>95</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>96</td><td class=content><nobr>int&nbsp;main(int&nbsp;argc,&nbsp;const&nbsp;char&nbsp;*argv[])<br ></nobr></td></tr><tr><td align=right class=linenumber>97</td><td class=content><nobr>{<br ></nobr></td></tr><tr><td align=right class=linenumber>98</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(argc&nbsp;&lt;&nbsp;2)&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>99</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printHelp(argc,&nbsp;argv);<br ></nobr></td></tr><tr><td align=right class=linenumber>100</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br ></nobr></td></tr><tr><td align=right class=linenumber>101</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>102</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>103</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;optMinLen&nbsp;=&nbsp;20;<br ></nobr></td></tr><tr><td align=right class=linenumber>104</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;optExtern&nbsp;=&nbsp;false;<br ></nobr></td></tr><tr><td align=right class=linenumber>105</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>106</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;seqCount&nbsp;=&nbsp;0;<br ></nobr></td></tr><tr><td align=right class=linenumber>107</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;arg&nbsp;=&nbsp;1;&nbsp;arg&nbsp;&lt;&nbsp;argc;&nbsp;++arg)&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>108</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(argv[arg][0]&nbsp;==&nbsp;'-')&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>109</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parse&nbsp;option<br ></nobr></td></tr><tr><td align=right class=linenumber>110</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>111</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(strcmp(argv[arg],&nbsp;"-e")&nbsp;==&nbsp;0&nbsp;||&nbsp;strcmp(argv[arg],&nbsp;"--extern")&nbsp;==&nbsp;0)&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>112</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;use&nbsp;external&nbsp;memory&nbsp;algorithms<br ></nobr></td></tr><tr><td align=right class=linenumber>113</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;optExtern&nbsp;=&nbsp;true;<br ></nobr></td></tr><tr><td align=right class=linenumber>114</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;<br ></nobr></td></tr><tr><td align=right class=linenumber>115</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>116</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(strcmp(argv[arg],&nbsp;"-l")&nbsp;==&nbsp;0&nbsp;||&nbsp;strcmp(argv[arg],&nbsp;"--minlen")&nbsp;==&nbsp;0)&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>117</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;minimum&nbsp;match&nbsp;length<br ></nobr></td></tr><tr><td align=right class=linenumber>118</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(arg&nbsp;+&nbsp;1&nbsp;==&nbsp;argc)&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>119</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printHelp(argc,&nbsp;argv);<br ></nobr></td></tr><tr><td align=right class=linenumber>120</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br ></nobr></td></tr><tr><td align=right class=linenumber>121</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>122</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++arg;<br ></nobr></td></tr><tr><td align=right class=linenumber>123</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;optMinLen&nbsp;=&nbsp;atoi(argv[arg]);<br ></nobr></td></tr><tr><td align=right class=linenumber>124</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;<br ></nobr></td></tr><tr><td align=right class=linenumber>125</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>126</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(strcmp(argv[arg],&nbsp;"-h")&nbsp;==&nbsp;0&nbsp;||&nbsp;strcmp(argv[arg],&nbsp;"--help")&nbsp;==&nbsp;0)&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>127</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;print&nbsp;help<br ></nobr></td></tr><tr><td align=right class=linenumber>128</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printHelp(argc,&nbsp;argv,&nbsp;true);<br ></nobr></td></tr><tr><td align=right class=linenumber>129</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br ></nobr></td></tr><tr><td align=right class=linenumber>130</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>131</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>132</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parse&nbsp;sequence&nbsp;file<br ></nobr></td></tr><tr><td align=right class=linenumber>133</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++seqCount;<br ></nobr></td></tr><tr><td align=right class=linenumber>134</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>135</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>136</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>137</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(optExtern)<br ></nobr></td></tr><tr><td align=right class=linenumber>138</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;runMummy&lt;External&lt;&gt;&nbsp;&gt;(argc,&nbsp;argv,&nbsp;seqCount,&nbsp;optMinLen);<br ></nobr></td></tr><tr><td align=right class=linenumber>139</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;else<br ></nobr></td></tr><tr><td align=right class=linenumber>140</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;runMummy&lt;Alloc&lt;&gt;&nbsp;&gt;(argc,&nbsp;argv,&nbsp;seqCount,&nbsp;optMinLen);<br ></nobr></td></tr><tr><td align=right class=linenumber>141</td><td class=content><nobr>}<br ></nobr></td></tr></table></div><div class=section id=output><div class=section_headline>Output</div><div class=text_block><div class=text_sub_block> If you run the tool on 2 sequences it outputs exactly the same matches as MUMmer (called with <span class=code><nobr>-mum</nobr></span> option), it
only differs in the order of outputted matches. To get matches with increasing positions at the first sequence we
piped the output to <span class=code><nobr>sort</nobr></span>.</div><div class=text_sub_block> As an example data set we used 3 strains of chlamydia bacterium 
(<a href="ftp://ftp.ncbi.nih.gov/genomes/Bacteria/Chlamydia_muridarum/NC_002620.fna" >NC_002620.fna</a>,
<a href="ftp://ftp.ncbi.nih.gov/genomes/Bacteria/Chlamydia_trachomatis/NC_000117.fna" >NC_000117.fna</a>,
<a href="ftp://ftp.ncbi.nih.gov/genomes/Bacteria/Chlamydia_trachomatis_A_HAR-13/NC_007429.fna" >NC_007429.fna</a>) and
saved the Fasta files to the demos directory.</div><div class=code_sub_block><span class=code><nobr>weese@tanne:~/seqan$&nbsp;cd&nbsp;demos<br >weese@tanne:~/seqan/demos$&nbsp;make&nbsp;index_mummy<br >weese@tanne:~/seqan/demos$&nbsp;./index_mummy&nbsp;-h<br >***************************************<br >***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simple&nbsp;MUM&nbsp;finder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;***<br >***&nbsp;written&nbsp;by&nbsp;David&nbsp;Weese&nbsp;(c)&nbsp;2007&nbsp;***<br >***************************************<br ><br >Usage:&nbsp;mummy&nbsp;[OPTION]...&nbsp;&lt;SEQUENCE&nbsp;FILE&gt;&nbsp;...&nbsp;&lt;SEQUENCE&nbsp;FILE&gt;<br ><br >Options:<br >&nbsp;&nbsp;-e,&nbsp;--extern&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;external&nbsp;memory&nbsp;(for&nbsp;large&nbsp;datasets)<br >&nbsp;&nbsp;-l,&nbsp;--minlen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;minimum&nbsp;MUM&nbsp;length<br >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;set,&nbsp;default&nbsp;value&nbsp;is&nbsp;20<br >&nbsp;&nbsp;-h,&nbsp;--help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;this&nbsp;help<br >weese@tanne:~/seqan/demos$&nbsp;./index_mummy&nbsp;NC*.fna&nbsp;|sort&nbsp;&gt;&nbsp;mums.txt<br >3159928&nbsp;bps&nbsp;sequence&nbsp;imported.<br >weese@tanne:~/seqan/demos$&nbsp;head&nbsp;mums.txt<br >&nbsp;&nbsp;&nbsp;&nbsp;1565&nbsp;&nbsp;&nbsp;&nbsp;323805&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2159&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;48<br >&nbsp;&nbsp;&nbsp;&nbsp;1646&nbsp;&nbsp;&nbsp;&nbsp;323886&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2240&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;27<br >&nbsp;&nbsp;&nbsp;&nbsp;1722&nbsp;&nbsp;&nbsp;&nbsp;323962&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2316&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;37<br >&nbsp;&nbsp;&nbsp;&nbsp;1774&nbsp;&nbsp;&nbsp;&nbsp;324014&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2368&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;26<br >&nbsp;&nbsp;&nbsp;&nbsp;1941&nbsp;&nbsp;&nbsp;&nbsp;324181&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2535&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23<br >&nbsp;&nbsp;&nbsp;&nbsp;2061&nbsp;&nbsp;&nbsp;&nbsp;324301&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2655&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;35<br >&nbsp;&nbsp;&nbsp;&nbsp;2102&nbsp;&nbsp;&nbsp;&nbsp;324342&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2696&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29<br >&nbsp;&nbsp;&nbsp;&nbsp;2132&nbsp;&nbsp;&nbsp;&nbsp;324372&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2726&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20<br >&nbsp;&nbsp;&nbsp;&nbsp;2183&nbsp;&nbsp;&nbsp;&nbsp;324423&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2777&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24<br >weese@tanne:~/seqan/demos$</nobr></span></div></div></div><div class="section" id="demofor"><div class="section_headline">See</div><div class="text_block"><span class="link_text"><a href="CLASS_Index.html" title="Contains preprocessing data of a fixed text. In combination with a Class.Finder or a Spec.VSTree Iterator it allows fast dictionary look-up and advanced computations." >Index</a></span>, <span class="link_text"><a href="SPEC_Mums+_Iterator.html" title="Iterator to search for all maximum unique matches." >Mums Iterator</a></span>, <span class="link_text"><a href="FUNCTION.get_Occurrences.html" title="Returns all occurrences of the Function.representative substring or a q-gram in the index text." >getOccurrences</a></span>, <span class="link_text"><a href="FUNCTION.representative.html" title="Returns a substring representing the path from root to iterator node." >representative</a></span>, <span class="link_text"><a href="FUNCTION.order_Occurrences.html" title="Sorts a string of occurrences." >orderOccurrences</a></span>, <span class="link_text"><a href="FUNCTION.rep_Length.html" title="Returns the length of the substring representing the path from root to iterator node." >repLength</a></span>, <span class="link_text"><a href="CLASS_String_Set.html" title="A container class for a set of strings." >StringSet</a></span></div></div><div class="section" id="see"><div class="section_headline">See Also</div><div class="text_block"><span class="link_text"><a href="DEMO_Maximal+_Unique+_Matches.html" title="Example for using the Spec.Mums Iterator." >Maximal Unique Matches</a></span></div></div><div class=page_footline>SeqAn - Sequence Analysis Library - <a href="http://www.seqan.de">www.seqan.de</a></div><div id=page_widthblock>&nbsp;</div></div></td></tr></table><p style="font-size:50%; color: #909090">Page built @2013/07/11 10:43:56</p></body></html>