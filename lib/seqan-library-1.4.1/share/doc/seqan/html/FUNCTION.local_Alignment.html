<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><link rel="stylesheet" href="dddoc_html.css" type="text/css" /><title>localAlignment</title></head><body><table id=main_table cellspacing=0 cellpadding=0><tr><td valign=top><iframe frameborder=0 id=navigation src="INDEX_Function_Alignments.html#localAlignment"></iframe></td><td valign=top><div id=content><div class=page_category>Function</div><div class=page_title>localAlignment</div><div id=summary><div class=text>Computes the best pairwise local alignment using the Smith-Waterman algorithm.</div></div><div class=section id=signature><div class=signature_block><nobr><span class=code><nobr>localAlignment(align,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scoringScheme,&nbsp;[lowerDiag,&nbsp;upperDiag])</nobr></span></nobr></div><div class=signature_block><nobr><span class=code><nobr>localAlignment(gapsH,&nbsp;gapsV,&nbsp;&nbsp;&nbsp;scoringScheme,&nbsp;[lowerDiag,&nbsp;upperDiag])</nobr></span></nobr></div><div class=signature_block><nobr><span class=code><nobr>localAlignment(fragmentString,&nbsp;scoringScheme,&nbsp;[lowerDiag,&nbsp;upperDiag])</nobr></span></nobr></div></div><div class=section id=include><div class=section_headline>Include Headers</div><div class=text_block>seqan/align.h</div></div><div class=section id=param><div class=section_headline>Parameters</div><table class=value_tab cellspacing=0 cellpadding=0><tr><td class=value_key valign=top><nobr>align</nobr></td><td class=value_text valign=top><div class=text_sub_block> 
An <a href="CLASS_Align.html" title="An alignment of sequences." >Align</a> object that stores the alignment.
The number of rows must be 2 and the sequences must have already been set.
<span class=code><nobr>align[0]</nobr></span> is the horizontal one in the alignment matrix alignment, <span class=code><nobr>align[1]</nobr></span> is the vertical one.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_Align.html" title="An alignment of sequences." >Align</a></div></td></tr><tr><td class=value_key valign=top><nobr>gapsH</nobr></td><td class=value_text valign=top><div class=text_sub_block> Horizontal gapped sequence in alignment matrix.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_Gaps.html" title="Efficient storage of gaps for a sequence." >Gaps</a></div></td></tr><tr><td class=value_key valign=top><nobr>gapsV</nobr></td><td class=value_text valign=top><div class=text_sub_block> Vertical gapped sequence in alignment matrix.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_Gaps.html" title="Efficient storage of gaps for a sequence." >Gaps</a></div></td></tr><tr><td class=value_key valign=top><nobr>fragmentString</nobr></td><td class=value_text valign=top><div class=text_sub_block> 
String of <a href="CLASS_Fragment.html" title="A type for ungapped, pairwise segment matches." >Fragment</a> objects.
The sequence with id <span class=code><nobr>0</nobr></span> is the horizontal one, the sequence with id <span class=code><nobr>1</nobr></span> is the vertical one.</div></td></tr><tr><td class=value_key valign=top><nobr>scoringScheme</nobr></td><td class=value_text valign=top><div class=text_sub_block> 
The scoring scheme to use for the alignment.
Note that the user is responsible for ensuring that the scoring scheme is compatible with <span class=code><nobr>algorithmTag</nobr></span>.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_Score.html" title="A scoring scheme." >Score</a></div></td></tr><tr><td class=value_key valign=top><nobr>lowerDiag</nobr></td><td class=value_text valign=top><div class=text_sub_block> Optional lower diagonal.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <span class=code><nobr>int</nobr></span></div></td></tr><tr><td class=value_key valign=top><nobr>upperDiag</nobr></td><td class=value_text valign=top><div class=text_sub_block> Optional upper diagonal.</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <span class=code><nobr>int</nobr></span></div></td></tr></table></div><div class=section id=remarks><div class=section_headline>Remarks</div><div class=text_block><div class=text_sub_block> The Waterman-Eggert algorithm (local alignment with declumping) is available through the <a href="CLASS_Local_Alignment_Enumerator.html" title="Enumerate local alignments using the Waterman-Eggert algorithm." >LocalAlignmentEnumerator</a> class.</div><div class=text_sub_block> 
When using <a href="CLASS_Gaps.html" title="Efficient storage of gaps for a sequence." >Gaps</a> and <a href="CLASS_Align.html" title="An alignment of sequences." >Align</a> objects, only parts (i.e. one infix) of each sequence will be aligned.
This will be presented to the user by setting the clipping begin and end position of the gaps (the rows in the case of <a href="CLASS_Align.html" title="An alignment of sequences." >Align</a> objects).
When using <a href="CLASS_Fragment.html" title="A type for ungapped, pairwise segment matches." >Fragment</a> strings, these parts of the sequences will not appear in any fragment.</div><div class=text_sub_block> 
There exist multiple overloads for this function with two configuration dimensions.</div><div class=text_sub_block> 
First, you can select the type of the target storing the alignment.
This can be either an <a href="CLASS_Align.html" title="An alignment of sequences." >Align</a> object, two <a href="CLASS_Gaps.html" title="Efficient storage of gaps for a sequence." >Gaps</a> objects, or a string of <a href="CLASS_Fragment.html" title="A type for ungapped, pairwise segment matches." >Fragment</a> objects.
<a href="CLASS_Align.html" title="An alignment of sequences." >Align</a> objects provide an interface to tabular alignments with the restriction of all rows having the same type.
Using two <a href="CLASS_Gaps.html" title="Efficient storage of gaps for a sequence." >Gaps</a> objects has the advantage that you an align sequences with different types, for example <a href="SHORTCUT_Dna_String.html" title="A string of Spec.Dna." >DnaString</a> and <a href="SHORTCUT_Dna5_String.html" title="A string of Spec.Dna5." >Dna5String</a>.
Using <a href="CLASS_Fragment.html" title="A type for ungapped, pairwise segment matches." >Fragment</a> strings is useful for collecting many pairwise alignments, for example in the construction of <a href="SPEC_Alignment+_Graph.html" title="An alignment graph." >Alignment Graphs</a> for multiple-sequence alignments (MSA).</div><div class=text_sub_block> 
Second, you can optionally give a band for the alignment using <span class=code><nobr>lowerDiag</nobr></span> and <span class=code><nobr>upperDiag</nobr></span>.
The center diagonal has index <span class=code><nobr>0</nobr></span>, the <span class=code><nobr>i</nobr></span>th diagonal below has index <span class=code><nobr>-i</nobr></span>, the <span class=code><nobr>i</nobr></span>th above has index <span class=code><nobr>i</nobr></span>.</div><div class=text_sub_block> 
The examples below show some common use cases.</div></div></div><div class=section id=returns><div class=section_headline>Return Values</div><div class=text_block><div class=text_sub_block> An integer with the alignment score, as given by the <a href="METAFUNCTION_Value.html" title="Type of the items in the container or behind an iterator." >Value</a> metafunction of the <a href="CLASS_Score.html" title="A scoring scheme." >Score</a> type.</div></div></div><div class=section id=example><div class=section_headline>Examples</div><div class=text_block><div class=text_sub_block> Local alignment of two sequences using an <a href="CLASS_Align.html" title="An alignment of sequences." >Align</a> object.</div><div class=code_sub_block><span class=code><nobr>Dna5String&nbsp;seqH&nbsp;=&nbsp;"CGATT";<br >Dna5String&nbsp;seqV&nbsp;=&nbsp;"CGAAATT";<br >&nbsp;<br >Align&lt;Dna5String&gt;&nbsp;align;<br >resize(rows(align),&nbsp;2);<br >assignSource(row(align,&nbsp;0),&nbsp;seqH);<br >assignSource(row(align,&nbsp;0),&nbsp;seqV);<br >Score&lt;int,&nbsp;Simple&gt;&nbsp;scoringScheme(2,&nbsp;-1,&nbsp;-2);<br >&nbsp;<br >int&nbsp;result&nbsp;=&nbsp;localAlignment(align,&nbsp;scoringScheme);</nobr></span></div><div class=text_sub_block> Local banded alignment of two sequences using two <a href="CLASS_Gaps.html" title="Efficient storage of gaps for a sequence." >Gaps</a> objects.</div><div class=code_sub_block><span class=code><nobr>Dna5String&nbsp;seqH&nbsp;=&nbsp;"CGATT";<br >Gaps&lt;Dna5String,&nbsp;ArrayGaps&gt;&nbsp;gapsH(seqH);<br >DnaString&nbsp;seqV&nbsp;=&nbsp;"CGAAATT";<br >Gaps&lt;Dna5String,&nbsp;AnchorGaps&lt;&gt;&nbsp;&gt;&nbsp;gapsV(seqV);<br >&nbsp;<br >Score&lt;int,&nbsp;Simple&gt;&nbsp;scoringScheme(5,&nbsp;-3,&nbsp;-1,&nbsp;-5);<br >&nbsp;<br >int&nbsp;result&nbsp;=&nbsp;localAlignment(gapsH,&nbsp;gapsV,&nbsp;scoringScheme,&nbsp;-2,&nbsp;2);</nobr></span></div></div></div><div class="section" id="demo"><div class="section_headline">Example Programs</div><div class="text_block"><span class="link_text"><a href="DEMO_Local+_Alignments.html" title="Computing local alignments between two sequences." >Local Alignments</a></span></div></div><div class="section" id="see"><div class="section_headline">See Also</div><div class="text_block"><span class="link_text"><a href="CLASS_Local_Alignment_Finder.html" title="Stores the information necessary for local alignment dynamic programming." >LocalAlignmentFinder</a></span>, <span class="link_text"><a href="CLASS_Local_Alignment_Enumerator.html" title="Enumerate local alignments using the Waterman-Eggert algorithm." >LocalAlignmentEnumerator</a></span>, <span class="link_text"><a href="TAG_Pairwise+_Local+_Alignment+_Algorithms.html" title="Tags used for selecting pairwise global alignment algorithms." >Pairwise Local Alignment Algorithms</a></span>, <span class="link_text"><a href="FUNCTION.global_Alignment.html" title="Computes the best global pairwise alignment." >globalAlignment</a></span></div></div><div class=page_footline>SeqAn - Sequence Analysis Library - <a href="http://www.seqan.de">www.seqan.de</a></div><div id=page_widthblock>&nbsp;</div></div></td></tr></table><p style="font-size:50%; color: #909090">Page built @2013/07/11 10:43:58</p></body></html>