<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><link rel="stylesheet" href="dddoc_html.css" type="text/css" /><title>calculateCovariance</title></head><body><table id=main_table cellspacing=0 cellpadding=0><tr><td valign=top><iframe frameborder=0 id=navigation src="INDEX_Function_Alignment+_Free.html#calculateCovariance"></iframe></td><td valign=top><div id=content><div class=page_category>Function</div><div class=page_title>calculateCovariance</div><div id=summary><div class=text>Calculates the covariance for the number of word occurrences for two words in a sequence of length n, given a background model.</div></div><div class=section id=signature><div class=signature_block><nobr><span class=code><nobr>calculateCovariance(covariance,&nbsp;word1,&nbsp;word2,&nbsp;backgroundFrequencies,&nbsp;n)</nobr></span></nobr></div><div class=signature_block><nobr><span class=code><nobr>calculateCovariance(covariance,&nbsp;word1,&nbsp;word2,&nbsp;bgModel,&nbsp;n)</nobr></span></nobr></div></div><div class=section id=include><div class=section_headline>Include Headers</div><div class=text_block>seqan/alignment_free.h</div></div><div class=section id=param><div class=section_headline>Parameters</div><table class=value_tab cellspacing=0 cellpadding=0><tr><td class=value_key valign=top><nobr>covariance</nobr></td><td class=value_text valign=top><div class=text_sub_block> Variance of the number of occurrences of the word in a sequence of length n given the model</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  double</div></td></tr><tr><td class=value_key valign=top><nobr>word1</nobr></td><td class=value_text valign=top><div class=text_sub_block> Usually a DNA sequence</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_String.html" title="A sequence container with generic alphabet and many specializations." >String</a></div></td></tr><tr><td class=value_key valign=top><nobr>word2</nobr></td><td class=value_text valign=top><div class=text_sub_block> Usually a DNA sequence</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_String.html" title="A sequence container with generic alphabet and many specializations." >String</a></div></td></tr><tr><td class=value_key valign=top><nobr>backgroundFrequencies</nobr></td><td class=value_text valign=top><div class=text_sub_block> String of background frequencies representing the model</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  double</div></td></tr><tr><td class=value_key valign=top><nobr>bgModel</nobr></td><td class=value_text valign=top><div class=text_sub_block> Markov model</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  <a href="CLASS_Markov_Model.html" title="Gives a suitable representation of a Marcov Chain." >MarkovModel</a></div></td></tr><tr><td class=value_key valign=top><nobr>n</nobr></td><td class=value_text valign=top><div class=text_sub_block> Length of the sequence where the occurrences of word are counted</div><div class=text_sub_block><span class=section_sub_headline>Types:</span>  integer</div></td></tr></table></div><div class=section id=remarks><div class=section_headline>Remarks</div><div class=text_block><div class=text_sub_block> Calculates the covariance for the number of word occurrences for two words in a sequence of length n given a background model (Markov model or Bernoulli model).
The covariance is influenced by the property of words to overlap, for example, the words ATAT and TATA have a high covariance since they are likely to overlap.
The formula is based on Robin, S., Rodolphe, F., and Schbath, S. (2005). DNA, Words and Models. Cambridge University Press.
See Jonathan Goeke et al (to appear) for details on the implementation.</div></div></div><div class=section id=returns><div class=section_headline>Return Values</div><div class=text_block><div class=text_sub_block> TValue covariance; Covariance of the number of occurrences of the word in a sequence of length n given the model</div></div></div><div class=section id=example><div class=section_headline>Examples</div><div class=text_block><div class=text_sub_block>  Calculate the covariance for the number of occurrences of ATATAT and TATATA in a sequence of length 10000bp with p(A)=p(T)=0.3 and p(C)=p(G)=0.2.</div><div class=code_sub_block><span class=code><nobr>using&nbsp;namespace&nbsp;seqan;<br >double&nbsp;covar&nbsp;=&nbsp;0.0;<br >int&nbsp;n&nbsp;=&nbsp;10000;<br >DnaString&nbsp;word1&nbsp;=&nbsp;"ATATAT";<br >DnaString&nbsp;word2&nbsp;=&nbsp;"TATATA";<br >String&lt;double&gt;&nbsp;model;<br >resize(model,&nbsp;4);<br >model[0]&nbsp;=&nbsp;0.3;&nbsp;&nbsp;//&nbsp;p(A)<br >model[1]&nbsp;=&nbsp;0.2;&nbsp;&nbsp;//&nbsp;p(C)<br >model[2]&nbsp;=&nbsp;0.2;&nbsp;&nbsp;//&nbsp;p(G)<br >model[3]&nbsp;=&nbsp;0.3;&nbsp;&nbsp;//&nbsp;p(T)<br >calculateCovariance(covar,&nbsp;word1,&nbsp;word2,&nbsp;model,&nbsp;n);&nbsp;&nbsp;//&nbsp;covar&nbsp;=&nbsp;4.74</nobr></span></div><div class=text_sub_block>  Estimate a Markov model on a set of sequences and calculate the covariance for the number of occurrences of ATATAT and TATATA in a sequence of length 10000bp.</div><div class=code_sub_block><span class=code><nobr>using&nbsp;namespace&nbsp;seqan;<br >double&nbsp;covar&nbsp;=&nbsp;0.0;<br >int&nbsp;n&nbsp;=&nbsp;10000;<br >DnaString&nbsp;word1&nbsp;=&nbsp;"ATATAT";<br >DnaString&nbsp;word2&nbsp;=&nbsp;"TATATA";<br >StringSet&lt;DnaString&gt;&nbsp;sequences;<br >appendValue(sequences,&nbsp;"CAGCACTGATTAACAGGAATAAGCAGTTTACTTCTGTCAGAATATTGGGCATATATA"<br >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"CTGGGACCCGTGTAATACTCTAATTTAATTAGGTGATCCCTGCGAAGTCTCCA");<br >MarkovModel&lt;Dna,&nbsp;double&gt;&nbsp;modelMM0(0);&nbsp;&nbsp;//&nbsp;Bernoulli&nbsp;model<br >modelMM0.build(sequences);<br >calculateCovariance(covar,&nbsp;word1,&nbsp;word2,&nbsp;modelMM0,&nbsp;n);&nbsp;&nbsp;//&nbsp;covar&nbsp;=&nbsp;4.74<br >MarkovModel&lt;Dna,&nbsp;double&gt;&nbsp;modelMM1(1);&nbsp;&nbsp;//&nbsp;First&nbsp;order&nbsp;Markov&nbsp;model<br >modelMM1.build(sequences);<br >calculateCovariance(covar,&nbsp;word1,&nbsp;word2,&nbsp;modelMM1,&nbsp;n);&nbsp;&nbsp;//&nbsp;covar&nbsp;=&nbsp;13.1541</nobr></span></div></div></div><div class="section" id="see"><div class="section_headline">See Also</div><div class="text_block"><span class="link_text"><a href="FUNCTION.alignment_Free_Comparison.html" title="Computes the pairwise similarity scores for a set of sequences" >alignmentFreeComparison</a></span>, <span class="link_text"><a href="FUNCTION.calculate_Probability.html" title="Calculates the probability of a sequence given a Bernoulli model (String of background frequencies)" >calculateProbability</a></span>, <span class="link_text"><a href="CLASS_Markov_Model.html" title="Gives a suitable representation of a Marcov Chain." >MarkovModel</a></span>, <span class="link_text"><a href="FUNCTION.calculate_Variance.html" title="Calculates the variance for the number of word occurrences of a word in a sequence of length n given a background model." >calculateVariance</a></span>, <span class="link_text"><a href="FUNCTION.calculate_Periodicity.html" title="Calculate word periodicity (indicator for overlaps)" >calculatePeriodicity</a></span>, <span class="link_text"><a href="FUNCTION.count_Kmers.html" title="Counts kmers in a sequence. Optionally, a background model is returned." >countKmers</a></span>, <span class="link_text"><a href="FUNCTION.calculate_Overlap_Indicator.html" title="Calculate word overlaps: epsilon(word1,word2)= 1 where word2[j]=word1[j+p] for all j=1...(k-p)" >calculateOverlapIndicator</a></span></div></div><div class=page_footline>SeqAn - Sequence Analysis Library - <a href="http://www.seqan.de">www.seqan.de</a></div><div id=page_widthblock>&nbsp;</div></div></td></tr></table><p style="font-size:50%; color: #909090">Page built @2013/07/11 10:43:57</p></body></html>